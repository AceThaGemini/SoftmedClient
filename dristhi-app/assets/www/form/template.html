<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
    <title>drishti forms</title>
    <meta charset="utf-8">
    <meta name="author" content="Martijn van de Rijdt (Aid Web Solutions) &amp; Modi Research Group">
    <meta name="robots" content="noindex">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link href="../../css/form/styles_drishti.css" media="all" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="../../js/form/libraries-all-min.js"></script>
    <script type="text/javascript" src="../../js/form/webform-drishti-all-min.js"></script>
    <script type="text/javascript" src="../../js/form/util.js"></script>
    <script type="text/javascript" src="../../js/form/form_model_mapper.js"></script>
    <script type="text/javascript" src="../../js/form/entity_relationship_loader.js"></script>
    <script type="text/javascript" src="../../js/form/entity.js"></script>
    <script type="text/javascript" src="../../js/form/relation_kind.js"></script>
    <script type="text/javascript" src="../../js/form/entity_relationships.js"></script>
    <script type="text/javascript" src="../../js/form/form_definition_loader.js"></script>
    <script type="text/javascript" src="../../js/form/sql_query_builder.js"></script>
    <script type="text/javascript" src="../../js/form/form_data_repository.js"></script>
    <script type="text/javascript" src="../../js/form/form_data_controller.js"></script>
    <script type="text/javascript">
        var settings = {};
        settings['mapsDynamicAPIKey'] = 'AIzaSyDF5xYZfxN7r5SsNPGstjAeTzwa6dVU4Ik';
        settings['mapsStaticAPIKey'] = 'AIzaSyDF5xYZfxN7r5SsNPGstjAeTzwa6dVU4Ik';
        settings['supportEmail'] = '';
        settings['returnURL'] = '';

        /*****  Paste the complete <model> node as the value for jrDataStr, remove linebreaks *****/
        var modelStr = androidContext.getModel();
        function getQueryStringParameterByName(name) {
            name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
            var regexS = "[\\?&]" + name + "=([^&#]*)";
            var regex = new RegExp(regexS);
            var results = regex.exec(window.location.search);
            if (results == null)
                return "";
            else
                return decodeURIComponent(results[1].replace(/\+/g, " "));
        }
        function getFormParams() {
            //to be parsed from query params
            return {id: "", formName: getQueryStringParameterByName("formName"), entityId: getQueryStringParameterByName("entityId")};
        }
        var formDataRepository = new enketo.FormDataRepository();
        var controller = new enketo.FormDataController(
                new enketo.EntityRelationshipLoader(),
                new enketo.FormDefinitionLoader(),
                new enketo.FormModelMapper(formDataRepository, new enketo.SQLQueryBuilder(formDataRepository)),
                getFormParams());
        var formDefnValues = controller.get();
        logContext.logError("formDefinition with values: " + JSON.stringify(formDefnValues));
    </script>
</head>
<body>
<header class="navbar navbar-inverse navbar-fixed-top" style="height: 0;"></header>
<div id="feedback-bar" class="alert">
    <i class="icon-info-sign"></i>
    <a href="#" class="close">&times;</a>
</div>

<div id="dialog-alert" class="modal hide fade ">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3></h3>
    </div>
    <div class="modal-body">
        <p class="alert alert-block alert-error"></p>
    </div>
    <div class="modal-footer">
        <span class="self-destruct-timer"></span>
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
</div>

<div id="dialog-confirm" class="modal hide fade">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3></h3>
    </div>
    <div class="modal-body">
        <p class="alert alert-block alert-error"></p>

        <p class="msg"></p>
    </div>
    <div class="modal-footer">
        <span class="self-destruct-timer"></span>
        <button class="negative btn">Close</button>
        <button class="positive btn btn-primary">Confirm</button>
    </div>
</div>

<div id="dialog-save" class="dialog" style="display: none;">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h3></h3>
    </div>
    <div class="modal-body">
        <form onsubmit="return false;">
            <span class="dialog-msg"></span>
            <span class="dialog-error ui-state-error"></span>
            <label>name:<input name="record-name" type="text"/></label>
            <label><input name="record-final" type="checkbox" value="true"/><span>final</span></label>
        </form>
    </div>
    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
</div>
<div class="main">
    <article class="paper">
        <div class="form-header clearfix"><span class="form-language-selector"><span>Choose Language</span></span></div>

        <script>
            document.write(androidContext.getForm());
        </script>

        <button id="validate-form" class="btn btn-primary btn-large"> Validate</button>
        <div class="enketo-power">
            Powered by <a href="http://enketo.org" title="enketo.org website">enketo</a>
        </div>
    </article>
</div>
</body>
</html>